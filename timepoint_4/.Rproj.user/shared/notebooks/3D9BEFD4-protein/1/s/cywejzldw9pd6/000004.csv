"0","# Create standard curve following kit instructions"
"0","standards <- tribble("
"0","  ~std, ~BSA_ug.mL,"
"0","  ""A"",        2000,"
"0","  ""B"",        1500,"
"0","  ""C"",        1000,"
"0","  ""D"",         750,"
"0","  ""E"",         500,"
"0","  ""F"",         250,"
"0","  ""G"",         125,"
"0","  ""H"",          25,"
"0","  ""I"",           0"
"0",")"
"0","std_curve <- df %>%"
"0","  unnest(merged) %>%"
"0","  filter(grepl(""Standard"", colony_id)) %>%"
"0","  select(plate, well, colony_id, abs562 = `562:562`) %>%"
"0","  rename(std = colony_id) %>%"
"0","  mutate(std = str_sub(std, 9, 9)) %>%"
"0","  group_by(std) %>%"
"0","  summarise(abs562 = mean(abs562)) %>%                       # calculate mean of standard duplicates"
"0","  mutate(abs562.adj = abs562 - abs562[std == ""I""]) %>%       # subtract blank absorbace value from all"
"0","  left_join(standards)"
"0","## Fit linear model for standard curve"
"0","# mod <- lm(BSA_ug.mL ~ abs562, data = std_curve)"
"0","# coef(mod)"
"0","## Fit nonlinear model for standard curve"
"0","mod <- nls(formula = BSA_ug.mL ~ z + a * exp(b * abs562.adj), start = list(z = 0, a = 1, b = 1), data = std_curve)"
"0","fitted <- mod %>% broom::augment()"
"0","# Plot standard curve"
"0","std_curve_plot <- std_curve %>%"
"0","  ggplot(aes(x = abs562.adj, y = BSA_ug.mL)) +"
"0","  geom_point(color = ""red"", size = 3) "
"0","std_curve_plot + "
"0","  geom_line(data = fitted, aes(x = abs562.adj, y = .fitted)) +"
"0","  labs(title = ""Standard curve"")"
